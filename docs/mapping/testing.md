# Тестирование карты

### Тестирование карты
Перед тестированием не забудьте сохранить изменения!  
Протестировать карту можно с помощью `mapinit <ID карты>`. Это снимет карту с паузы и **инициализирует** её - камеры подключатся к роутерам, спавнеры заспавнят предметы и т.п. При этом функционал карты может быть ограничен по сравнению с обычным раундом. **Сохранять инициализированную карту нельзя - она не будет загружаться.**  
Чтобы продолжить маппинг, вы можете загрузить ту же карту (вы же сохранили изменения перед тестированием?) через mapping но с другим ID.
Однако, во избежание лишней нагрузки на процессор я рекомендую делать полный рестарт раунда (restartroundnow). Это уберёт все карты что вы загрузили через mapping или loadmap.

### Тестирование карты в раунде
Для тестирования карты в раунде вам потребуется создать новый прототип станции. 

1. Сначала переместите карту из data в папку `Resources/Maps` - там лежат файлы карт.
2. Прототипы станций хранятся в другой папке - в `/Resources/Prototypes/Maps/`. Зайдите туда и скопируйте любой из лежащих там .yml файлов. Оставьте его в этой же папке и дайте ему название латиницей без пробелов.
3. Откройте его в любом текстовом редакторе (блокнот подойдёт, но для редактирования прототипов Notepad++ будет удобнее).
4. Найдите строку начинающуюся на `id:` (она ближе к началу файла) и впишите туда любой не занятый ID вместо существующего. Пишется латиницей без пробелов. Удобнее всего если он схож с названием карты. Этот ID будет использоваться для загрузки карты через `forcemap`.
5. Найдите строку `mapPath:`, она тоже близко к началу файла. Укажите в ней путь к файлу карты. Обратите внимание на то что путь начинается с `/Maps`. Так же проверьте не используете ли вы символ \\ в пути (он там может быть если вы скопировали его из проводника). Если они там есть, замените их на `/`
6. Сохраните файл. Перезапустите сервер и введите в консоли forcemap <ID который указан в вашем прототипе>. При вводе ID должен появлятся в подсказках автозаполнения. После этого введите restartroundnow. Если загрузить карту не вышло, то скорее всего вы допустили синтаксическую ошибку в прототпе карты.

Теперь вы можете тестировать вашу карту в полноценном раунде. Если вы обновили свою карту, то достаточно перекинуть её из data в Resources/Maps заменив старую версию. Убедитесь что имя файла осталось то же что и раньше. После этого будет достаточно еще раз прописать forcemap и перезапустить раунд.  
Так же некоторые профессии могут отсутствовать даже если вы добавили спавнер. Это происходит из-за того, что доступные профессии и количество сотрудников перечислены в прототипе карты, ниже строки `availableJobs:`  
Редактируйте осторожно, ошибки синтаксиса приведут к тому что прототип карты не будет загружен и вы просто не найдёте своей карты. При изменениях в прототипе перезапустить раунд недостаточно, нужно перезапускать весь сервер.